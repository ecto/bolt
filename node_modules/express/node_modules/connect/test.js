
/**
 * Module dependencies.
 */

var connect = require('./')
  , http = require('http')
  , fs = require('fs');

// connect()
//   .use(connect.logger(':req[accept] -> :res[content-type]'))
//   .use(connect.favicon())
//   .use('/connect', connect.static(__dirname + '/lib'))
//   .use('/connect', connect.directory(__dirname + '/lib'))
//   .use(function(req, res, next){
//     var body = 'OK';
//     res.setHeader('Content-Length', body.length);
//     res.end(body);
//   })
//   .listen(3000);


// http.createServer(connect()
//   .use(connect.favicon())
//   .use(connect.cookieParser())
//   .use(connect.session({ secret: 'test' }))
//   .use(function(req, res, next){
//     console.log(req.header);
//     res.end('hey\n');
//   })
// ).listen(3000);

// TODO: make sure it's nice to use within handler

// http.createServer(connect()
//   .use(connect.favicon())
//   .use(connect.logger({ immediate: true, format: ':method :url' }))
//   .use(function(req, res, next){
//     setTimeout(next, 5000);
//   })
// ).listen(3000);

// var app = connect()
//   .use(connect.favicon())
//   .use(function(req, res){
//     res.end('Hello\n');
//   });

// TODO: cache

// ab -n 5000 -c 50 -k http://local/Readme.md
// connect: 2665
// node-static: 5425

// connect()
//   .use(connect.static(__dirname))
//   .listen(3000);

var static = require('node-static')
  , file = new static.Server(__dirname);

var send = connect.static(__dirname);
http.createServer(function(req, res){
  file.serve(req, res);
}).listen(3000);